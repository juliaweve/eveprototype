<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Eve AI Prototype</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
:root{--w:700px}

/* ——— base layout ——— */
body{margin:0;height:100vh;background:radial-gradient(ellipse at top,#71428A 0%,#0A0A0A 90%,#000);color:#F4F4F5;font-family:Inter,sans-serif;overflow:hidden}
.wrapper{margin-left:56px;padding:24px 24px 200px;height:100%;display:flex;justify-content:center}
.column{width:100%;max-width:var(--w);display:flex;flex-direction:column;height:100%}

/* ——— sidebar ——— */
.sidebar{position:fixed;inset:0 auto 0 0;width:56px;background:#18181B;display:flex;flex-direction:column;justify-content:space-between;align-items:center}
.side-group{display:flex;flex-direction:column;align-items:center;gap:8px;padding:8px 0}
.side-btn{width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:#2b2b2f;cursor:pointer}
.side-btn.active{background:#3d3d43}

/* avatar dropdown */
#avatarWrap{position:relative}
#avatarMenu{position:absolute;bottom:60px;left:-20px;background:#2e2e33;border:1px solid rgba(255,255,255,.15);border-radius:10px;padding:8px 0;min-width:140px;display:none}
#avatarMenu a{display:block;padding:8px 16px;font-size:14px;color:#F4F4F5;text-decoration:none}
#avatarMenu a:hover{background:rgba(255,255,255,.08)}

/* ——— header / filters ——— */
.title-bar{display:flex;align-items:center;justify-content:space-between;margin-bottom:32px}
.filters{display:flex;gap:12px;position:relative}
.pill{padding:6px 20px;border-radius:8px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.08);font-size:14px;cursor:pointer}
.dropdown{position:absolute;min-width:200px;background:linear-gradient(#4c3a58,#71428A);border:1px solid rgba(255,255,255,.2);border-radius:12px;padding:10px 0;box-shadow:0 4px 14px rgba(0,0,0,.4);z-index:50}
.dropdown.hidden{display:none}
.dropdown label{display:flex;align-items:center;gap:10px;padding:8px 18px;font-size:14px;cursor:pointer}
.dropdown label:hover{background:rgba(255,255,255,.06)}
.dropdown input{width:18px;height:18px}
.dropdown .actions{display:flex;justify-content:space-between;padding:10px 18px 4px;font-size:14px;color:#d1d1d1}
.dropdown .actions button{padding:4px 12px;border-radius:6px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.05);cursor:pointer}
.dropdown .actions button:hover{background:rgba(255,255,255,.1)}

/* ——— status bar ——— */
.status-wrap{display:flex;justify-content:center;gap:36px;padding:10px 32px;margin-bottom:24px;background:#4c3a58;border:1px solid rgba(255,255,255,.12);border-radius:16px}
.status-item{background:none;border:none;color:#F4F4F5;font-size:15px;display:flex;align-items:center;gap:8px;cursor:pointer}
.status-item::before{content:"○"}
.status-item span{padding:3px 8px;border-radius:6px;font-size:12px;background:rgba(255,255,255,.10)}
.status-item.active{background:rgba(255,255,255,.12);border-radius:12px;padding:8px 20px}
#backBtn{margin-bottom:24px}

/* ——— scroll zone ——— */
.content-area{overflow-y:auto;flex:1 1 0;scrollbar-width:none}
.content-area::-webkit-scrollbar{display:none}

/* ——— task card ——— */
.task-card{background:#4c3a58;border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:16px;display:flex;flex-direction:column;gap:16px}
.inner{background:#5b4767;border-radius:10px;padding:24px;display:flex;flex-direction:column;gap:16px}
.card-top{display:flex;justify-content:space-between;font-size:15px}
.card-tags{display:flex;gap:8px;font-size:13px}
.tag-grey{background:rgba(255,255,255,.12);padding:3px 7px;border-radius:6px}
.tag-hot{background:#D97706;padding:3px 7px;border-radius:6px}
.card-desc{font-size:15px;line-height:1.45;color:#E5E5E5}
.card-actions{display:flex;gap:10px;flex-wrap:wrap;padding-top: 10px;}
.btn{padding:7px 14px;font-size:13px;border-radius:7px;border:none;cursor:pointer}
.btn-primary{background:#C026D3;color:#fff}
.btn-secondary{background:rgba(255,255,255,.10);color:#F4F4F5}

/* ——— company chip ——— */
.company-chip{background:rgba(255,255,255,.12);padding:3px 7px;border-radius:6px;font-size:12px;margin-left:8px}

/* ——— chat thread ——— */
.chat-thread{display:flex;flex-direction:column;gap:20px;margin-top:40px}
.msg-ai{align-self:flex-start;font-size:15px;max-width:85%}
.typing{align-self:flex-start;font-size:28px;letter-spacing:3px}
@keyframes bl{0%{opacity:.25}50%{opacity:1}100%{opacity:.25}}
.typing span{animation:bl 1s infinite}

/* ——— input ——— */
.chat-box{position:fixed;left:56px;right:0;bottom:28px;margin:0 auto;width:var(--w);height:110px;background:#464646;border:1px solid rgba(255,255,255,.25);border-radius:14px;padding:10px 20px}
.chat-input{width:100%;height:100%;background:transparent;border:none;color:#fff;font-size:17px;padding-bottom:42px;outline:none}
.chat-input::placeholder{color:rgba(255,255,255,.6)}
.hint{position:absolute;left:24px;bottom:10px;font-size:12px;color:#d4d4d4}

/* ——— util ——— */
.hidden{display:none!important}
</style>
</head>
<body>

<!-- SIDEBAR -->
<nav class="sidebar">
  <div class="side-group">
    <img src="front.png" class="w-10" alt="">
    <button class="side-btn active"><img src="icon.png" class="w-5" alt=""></button>
  </div>
  <div id="avatarWrap" class="side-group pb-4 cursor-pointer">
    <img id="avatarImg" src="profile.png" class="w-10 h-10 rounded-full object-cover" alt="">
    <div id="avatarMenu"><a href="login.html">Log Out</a></div>
  </div>
</nav>

<div class="wrapper">
  <div class="column">

    <!-- HEADER -->
    <div class="title-bar">
      <h1 class="text-3xl font-semibold">Tasks</h1>
      <div class="filters">
        <button id="clientBtn" class="pill">Clients ▾</button>
        <div id="clientDrop" class="dropdown hidden">
          <label><input type="checkbox" value="fitxpress" checked> FitXpress</label>
          <label><input type="checkbox" value="redcorp"  checked> RedCorp</label>
          <label><input type="checkbox" value="caramelis" checked> Caramelis</label>
          <label><input type="checkbox" value="netfred"  checked> Netfred</label>
          <label><input type="checkbox" value="microfint" checked> MicroFint</label>
          <label><input type="checkbox" value="alohello" checked> AloHello</label>
          <div class="actions"><button id="clientClear">Clear</button><button id="clientClose">Close</button></div>
        </div>

        <button id="userBtn" class="pill">Users ▾</button>
        <div id="userDrop" class="dropdown hidden">
          <label><input type="checkbox" value="boots" checked> Boots</label>
          <label><input type="checkbox" value="ace"   checked> Ace</label>
          <label><input type="checkbox" value="corp"  checked> Corp</label>
          <div class="actions"><button id="userClear">Clear</button><button id="userClose">Close</button></div>
        </div>
      </div>
    </div>

    <!-- STATUS -->
    <div id="statusBar" class="status-wrap">
      <button class="status-item active" data-status="new">New <span>2</span></button>
      <button class="status-item" data-status="progress">In Progress <span>1</span></button>
      <button class="status-item" data-status="done">Done <span>3</span></button>
      <button class="status-item" data-status="cancel">Cancelled <span>2</span></button>
    </div>

    <button id="backBtn" class="pill hidden">← Back</button>

    <!-- SCROLLABLE AREA -->
    <div id="contentArea" class="content-area">
      <div id="tasks" class="space-y-8">

        <!-- NEW -->
        <div class="task-card" data-status="new" data-client="caramelis" data-user="boots">
          <div class="inner">
            <div class="card-top"><div>○ Send 2-week Caramelis Demo</div><span class="text-xs text-white/70">Today</span></div>
            <div class="card-tags"><span class="tag-grey">Boots</span><span class="tag-hot">Hot Prospect</span></div>
            <p class="card-desc">Set up demo environment and email credentials to Caramelis users.</p>
          </div>
          <div class="card-actions"><button class="btn btn-primary action-btn">Create Draft</button></div>
        </div>

        <div class="task-card" data-status="new" data-client="caramelis" data-user="ace">
          <div class="inner">
            <div class="card-top"><div>○ Schedule Demo with CFO</div><span class="text-xs text-white/70">Yesterday</span></div>
            <div class="card-tags"><span class="tag-grey">Ace</span><span class="tag-hot">Hot Prospect</span></div>
            <p class="card-desc">Arrange a product demo with the CFO and Head of Product next week.</p>
          </div>
          <div class="card-actions"><button class="btn btn-primary action-btn">Propose Meeting</button></div>
        </div>

        <!-- IN PROGRESS -->
        <div class="task-card" data-status="progress" data-client="netfred" data-user="corp">
          <div class="inner">
            <div class="card-top"><div>○ Ongoing Product Walkthrough</div><span class="text-xs text-white/70">Due Tomorrow</span></div>
            <div class="card-tags"><span class="tag-grey">Corp</span></div>
            <p class="card-desc">Coordinate walkthrough with client stakeholders and finalize materials.</p>
          </div>
          <div class="card-actions"><button class="btn btn-secondary">Update</button></div>
        </div>

        <!-- DONE -->
        <div class="task-card" data-status="done" data-client="redcorp" data-user="boots">
          <div class="inner">
            <div class="card-top"><div>○ Close Deal with RedCorp</div><span class="text-xs text-white/70">Jun 9</span></div>
            <div class="card-tags"><span class="tag-grey">Boots</span></div>
            <p class="card-desc">Contract signed and onboarding started.</p>
          </div>
          <div class="card-actions"><button class="btn btn-secondary">See Details</button></div>
        </div>

        <div class="task-card" data-status="done" data-client="fitxpress" data-user="ace">
          <div class="inner">
            <div class="card-top"><div>○ Finished Task 2</div><span class="text-xs text-white/70">Jun 8</span></div>
            <div class="card-tags"><span class="tag-grey">Ace</span></div>
            <p class="card-desc">Completed background reporting.</p>
          </div>
          <div class="card-actions"><button class="btn btn-secondary">See Details</button></div>
        </div>

        <div class="task-card" data-status="done" data-client="microfint" data-user="corp">
          <div class="inner">
            <div class="card-top"><div>○ Confirm Venue for Seminar</div><span class="text-xs text-white/70">Jun 7</span></div>
            <div class="card-tags"><span class="tag-grey">Corp</span></div>
            <p class="card-desc">Venue locked for August seminar.</p>
          </div>
          <div class="card-actions"><button class="btn btn-secondary">See Details</button></div>
        </div>

        <!-- CANCELLED -->
        <div class="task-card" data-status="cancel" data-client="alohello" data-user="ace">
          <div class="inner">
            <div class="card-top"><div>○ Prospect Withdrawal</div><span class="text-xs text-white/70">Jun 6</span></div>
            <div class="card-tags"><span class="tag-grey">Ace</span></div>
            <p class="card-desc">Client withdrew interest after negotiations.</p>
          </div>
          <div class="card-actions"><button class="btn btn-secondary">Reason</button></div>
        </div>

        <div class="task-card" data-status="cancel" data-client="boots" data-user="boots">
          <div class="inner">
            <div class="card-top"><div>○ Cancel Internal Audit</div><span class="text-xs text-white/70">Jun 5</span></div>
            <div class="card-tags"><span class="tag-grey">Boots</span></div>
            <p class="card-desc">Audit postponed due to resource constraints.</p>
          </div>
          <div class="card-actions"><button class="btn btn-secondary">Reason</button></div>
        </div>
      </div>

      <div id="chatThread" class="chat-thread hidden"></div>
    </div>
  </div>
</div>

<!-- CHAT INPUT -->
<div class="chat-box">
  <input id="chatInput" class="chat-input" type="text" placeholder="Type @ to mention someone or / to use commands…">
  <span class="hint">Shift + enter a new line</span>
</div>

<script>
/* ——— company & refs ——— */
const COMPANY = localStorage.getItem('eve_company')||'Your Company';
const SITE_URL= localStorage.getItem('eve_url')||'your-company.com';
const domain  = SITE_URL.replace(/^https?:\/\/?/i,'').split('/')[0];

const tasks=[...document.querySelectorAll('.task-card')],
      statusBtns=[...document.querySelectorAll('.status-item')],
      clientBtn=document.getElementById('clientBtn'),clientDrop=document.getElementById('clientDrop'),
      userBtn=document.getElementById('userBtn'),userDrop=document.getElementById('userDrop'),
      backBtn=document.getElementById('backBtn'),
      chatThread=document.getElementById('chatThread'),
      chatInput=document.getElementById('chatInput'),
      tasksBox=document.getElementById('tasks'),
      statusBar=document.getElementById('statusBar'),
      filtersEl=document.querySelector('.filters'),
      avatarImg=document.getElementById('avatarImg'),avatarMenu=document.getElementById('avatarMenu');

let currentStatus='new', awaitingDraftConfirm=false, awaitingDraftClient='';

/* ——— add company chips ——— */
tasks.forEach(card=>{
  const client=card.dataset.client[0].toUpperCase()+card.dataset.client.slice(1);
  const titleEl=card.querySelector('.card-top div');
  titleEl.style.display='flex';
  titleEl.style.alignItems='center';
  titleEl.style.gap='8px';
  const chip=document.createElement('span');
  chip.className='company-chip';
  chip.textContent=client;
  titleEl.appendChild(chip);
});

/* ——— helper builders ——— */
const slug=s=>s.toLowerCase().replace(/[^a-z0-9]/g,'');
const genEmail=c=>`${slug(c)}@${slug(c)}.com`;
const fromEmail=`john@${domain}`;
const bubble=t=>{const d=document.createElement('div');d.className='p-4 text-fuchsia-200 text-sm bg-white/5 rounded-tl-xl rounded-tr-xl rounded-br-xl rounded-bl-sm inline-block self-end';d.textContent=t;return d;}
const aiBubble=h=>{const d=document.createElement('div');d.className='msg-ai';d.innerHTML=h;return d;}
const typing=()=>{const t=document.createElement('div');t.className='typing';t.innerHTML='<span>•</span><span>•</span><span>•</span>';return t;}
function appendAI(html){const el=aiBubble(html);chatThread.appendChild(el);el.scrollIntoView({behavior:'smooth'});}

/* ——— AI messages ——— */
function draftConfirm(c){return`I'll create a draft email to <strong>${genEmail(c)}</strong> for you. Since you'd like me to create the subject and message, let me confirm the details before proceeding:<br><br><b>Email Details to Confirm:</b><br><br><strong>To:</strong> ${genEmail(c)}<br><strong>Subject:</strong> I'll create a general subject line<br><strong>Message:</strong> I'll create a professional introductory message<br><strong>CC:</strong> None<br><strong>From:</strong> ${fromEmail}<br><br><strong>Proposed Subject:</strong> "Hello from ${COMPANY}"<br><br><strong>Proposed Message:</strong><br>Hi there,<br><br>I hope you're doing well. It's John reaching out to set up demo environment and email credentials to ${c} users!<br><br>Looking forward to hearing from you.<br><br>Does this look good? Reply <em>Yes</em> to send or <em>No</em> to adjust.`;}
const draftSent=c=>`Perfect! I'll send the meeting invitation email now with the confirmed details:<br><br><b>Confirming the email details before sending:</b><br><strong>To:</strong> ${genEmail(c)}<br><strong>Subject:</strong> Meeting Request - Demo Environment<br><strong>Body:</strong> General meeting request for 30-minute connection and collaboration discussion<br><br>✅ Email sent successfully!<br>The invitation has been sent to ${genEmail(c)} with the subject "Meeting Request - Demo Environment".<br><br><u>The email includes</u>:<br>• A request for a 30-minute meeting<br>• Flexible timing for next week<br>• Request for their availability<br>• Professional introduction as your virtual assistant<br><br>`;
const draftAdjust=()=>`Oh no! So let's improve this draft. What information would you like me to change?`;
function meetingPrompt(c){return`I'll help you schedule a meeting with <strong>${c}</strong>. Let me first get the current time and then gather the necessary details.<br><br>I can help you schedule this meeting in two ways:<br>• <b>Direct booking</b>: I can directly book a calendar event if you have a specific time in mind<br>• <b>Email invitation</b>: I can start an email thread with ${genEmail(c)} to discuss and find a suitable time<br><br>Which approach would you prefer?<br><br>Also, please let me know:<br>• What's the purpose/topic of this meeting?<br>• How long should the meeting be? (e.g., 30 minutes, 1 hour)<br>• Any preferred timeframe or specific dates you have in mind?<br><br>This will help me suggest the best available slots or create an appropriate meeting invitation.`;}
const marketingMsg=`Hey – this is <strong>EVE</strong>. EVE is an AI RevOps for SMBs that uncovers missed revenue hiding in email data. It analyzes inboxes to surface forgotten leads, stalled deals, and upsell signals – then recommends smart, personalized next steps with deep business context so lean teams can act fast and close more without changing how they work.`;

/* ——— avatar dropdown ——— */
avatarImg.onclick=e=>{e.stopPropagation();avatarMenu.style.display=avatarMenu.style.display==='block'?'none':'block';};
document.addEventListener('click',e=>{if(!avatarMenu.contains(e.target)&&e.target!==avatarImg)avatarMenu.style.display='none';});

/* ——— dropdown positioning ——— */
const placeDrop=(btn,drop)=>{const b=btn.getBoundingClientRect(),f=filtersEl.getBoundingClientRect();drop.style.left=(b.left-f.left)+'px';drop.style.top=(b.height+6)+'px';};
clientBtn.onclick=e=>{e.stopPropagation();placeDrop(clientBtn,clientDrop);clientDrop.classList.toggle('hidden');userDrop.classList.add('hidden');};
userBtn.onclick  =e=>{e.stopPropagation();placeDrop(userBtn,userDrop);userDrop.classList.toggle('hidden');clientDrop.classList.add('hidden');};
document.addEventListener('click',e=>{if(!clientDrop.contains(e.target)&&e.target!==clientBtn)clientDrop.classList.add('hidden');
                                       if(!userDrop.contains(e.target)&&e.target!==userBtn)userDrop.classList.add('hidden');});

/* ——— filtering ——— */
const getChecked=d=>[...d.querySelectorAll('input:checked')].map(i=>i.value);
function filter(){const c=getChecked(clientDrop),u=getChecked(userDrop);
  tasks.forEach(card=>{card.style.display=card.dataset.status===currentStatus&&(c.length===0||c.includes(card.dataset.client))&&(u.length===0||u.includes(card.dataset.user))?'block':'none';});}
[...clientDrop.querySelectorAll('input'),...userDrop.querySelectorAll('input')].forEach(i=>i.onchange=filter);
clientDrop.querySelector('#clientClear').onclick=()=>{clientDrop.querySelectorAll('input').forEach(i=>i.checked=false);filter();};
userDrop.querySelector('#userClear').onclick=()=>{userDrop.querySelectorAll('input').forEach(i=>i.checked=false);filter();};
clientDrop.querySelector('#clientClose').onclick=()=>clientDrop.classList.add('hidden');
userDrop.querySelector('#userClose').onclick=()=>userDrop.classList.add('hidden');

/* ——— status switching ——— */
const showList=()=>{chatThread.classList.add('hidden');chatThread.innerHTML='';tasksBox.classList.remove('hidden');statusBar.classList.remove('hidden');backBtn.classList.add('hidden');awaitingDraftConfirm=false;filter();}
statusBtns.forEach(b=>b.onclick=()=>{document.querySelector('.status-item.active').classList.remove('active');b.classList.add('active');currentStatus=b.dataset.status;showList();});
filter();

/* ——— chat send ——— */
chatInput.addEventListener('keydown',e=>{
  if(e.key==='Enter'&&!e.shiftKey){
    e.preventDefault();

    /* open chat view if user types before selecting card */
    if(chatThread.classList.contains('hidden')){
      chatThread.classList.remove('hidden');
      tasksBox.classList.add('hidden');
      statusBar.classList.add('hidden');
      backBtn.classList.remove('hidden');
    }

    const txt=chatInput.value.trim();
    if(!txt) return;
    chatInput.value='';
    chatThread.appendChild(bubble(txt)).scrollIntoView({behavior:'smooth'});

    if(awaitingDraftConfirm){
      const dots=typing();chatThread.appendChild(dots);
      const ans=txt.toLowerCase();
      setTimeout(()=>{dots.remove();
        if(ans==='yes'){appendAI(draftSent(awaitingDraftClient));awaitingDraftConfirm=false;}
        else if(ans==='no'){appendAI(draftAdjust());}
        else appendAI('Please reply with “Yes” or “No”.');
      },1500);
      return;
    }

    const dots=typing();chatThread.appendChild(dots);
    setTimeout(()=>{dots.remove();appendAI(marketingMsg);},1500);
  }
});

/* ——— card actions ——— */
document.querySelectorAll('.action-btn').forEach(btn=>{
  btn.onclick=e=>{
    const card=e.target.closest('.task-card');
    const client=card.dataset.client.replace(/^\w/,m=>m.toUpperCase());
    tasks.forEach(c=>c.style.display=c===card?'block':'none');
    statusBar.classList.add('hidden');
    backBtn.classList.remove('hidden');
    chatThread.classList.remove('hidden');chatThread.innerHTML='';
    chatThread.appendChild(bubble(btn.textContent));
    const dots=typing();chatThread.appendChild(dots);

    if(btn.textContent.includes('Draft')){
      awaitingDraftConfirm=true;awaitingDraftConfirm=client;
      setTimeout(()=>{dots.remove();appendAI(draftConfirm(client));awaitingDraftClient=client;},1500);
    }else{
      awaitingDraftConfirm=false;
      setTimeout(()=>{dots.remove();appendAI(meetingPrompt(client));},1500);
    }
  };
});
backBtn.onclick=showList;
</script>
</body>
</html>
